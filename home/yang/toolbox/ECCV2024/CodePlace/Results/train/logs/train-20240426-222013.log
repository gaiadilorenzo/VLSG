[2024-04-26 22:20:13] [INFO] Command executed: ./src/trainval/trainval_patchobj_TXAE_SGIAE.py --config ./scripts/train_val/train.yaml
[2024-04-26 22:20:13] [INFO] Configs:
{
    "data": {
        "name": "Scan3R",
        "root_dir": null,
        "rescan": true,
        "temporal": true,
        "resplit": true,
        "img": {
            "img_step": 1,
            "w": 960,
            "h": 540
        },
        "img_encoding": {
            "resize_w": 1024,
            "img_rotate": true,
            "patch_w": 16,
            "patch_h": 9,
            "record_feature": false,
            "use_feature": true,
            "preload_feature": false,
            "feature_dir": "Features2D/DinoV2_16_9_scan",
            "resize_h": 576
        },
        "cross_scene": {
            "use_cross_scene": true,
            "num_scenes": 9,
            "num_negative_samples": -1,
            "use_tf_idf": false
        },
        "scene_graph": {
            "obj_img_patch": "Features3D/obj_dinov2_top10_l3",
            "obj_patch_num": 100,
            "obj_topk": 10,
            "use_predicted": false
        },
        "auxiliary": {
            "use_patch_depth": false,
            "depth_dir": ""
        }
    },
    "model": {
        "backbone": {
            "name": "GCViT",
            "cfg_file": "/home/yang/toolbox/ECCV2024/CodePlace/OfficialCode/VLSG/./src/models/GCVit/configs/gcvit/cascade_mask_rcnn_gcvit_tiny_3x_coco.py",
            "pretrained": "/home/yang/toolbox/ECCV2024/CodePlace/OfficialCode/VLSG/./checkpoint/GCVit/gcvit_1k_tiny.pth.tar",
            "use_pretrained": false,
            "num_reduce": 0,
            "backbone_dim": 1536
        },
        "patch": {
            "hidden_dims": [
                512
            ],
            "encoder_dim": 400,
            "gcn_layers": 2
        },
        "obj": {
            "embedding_dim": 656,
            "embedding_hidden_dims": [
                512,
                512
            ],
            "encoder_dim": 400
        },
        "other": {
            "drop": 0.1
        },
        "global_descriptor_dim": 1024
    },
    "sgaligner": {
        "modules": [
            "point",
            "gat",
            "rel",
            "attr",
            "img_patch"
        ],
        "use_pos_enc": true,
        "use_pretrained": false,
        "pretrained": "",
        "label_file_name": "labels.instances.annotated.v2.ply",
        "pred_subfix": "inseg.ply",
        "seed": 42,
        "model_name": "sgaligner",
        "use_predicted": false,
        "registration": false,
        "scan_type": "scan",
        "img_transformer": false,
        "preprocess": {
            "pc_resolutions": [
                64,
                128,
                256,
                512
            ],
            "subscenes_per_scene": 1,
            "filter_segment_size": 512,
            "min_obj_points": 50,
            "anchor_type_name": ""
        },
        "model": {
            "rel_dim": 41,
            "attr_dim": 164,
            "img_patch_feat_dim": 1536,
            "img_emb_dim": 256,
            "alignment_thresh": 0.4,
            "multi_view_aggregator": "transformer"
        },
        "train": {
            "pc_res": 512
        },
        "val": {
            "pc_res": 512,
            "overlap_low": 0.0,
            "overlap_high": 0.0,
            "data_mode": "orig"
        }
    },
    "train": {
        "gpus": 1,
        "precision": 16,
        "batch_size": 16,
        "num_workers": 16,
        "freeze_backbone": false,
        "use_pretrained": false,
        "log_steps": 20,
        "snapshot_steps": 1,
        "optim": {
            "lr": 0.0011,
            "scheduler": "step",
            "lr_decay": 0.97,
            "lr_decay_steps": 1,
            "lr_min": 0.0005,
            "T_max": 1000,
            "T_mult": 1,
            "weight_decay": 1e-06,
            "max_epoch": 10500,
            "free_backbone_epoch": 10500,
            "grad_acc_steps": 1,
            "free_sgaligner_epoch": -1
        },
        "loss": {
            "use_temporal": true,
            "loss_type": "ICLLossBothSidesSumOutLog",
            "alpha": 0.5,
            "temperature": 0.1,
            "margin": 0.5,
            "epsilon": 1e-08,
            "use_global_descriptor": false,
            "global_loss_coef": 0.5,
            "global_desc_temp": 1.0
        },
        "use_vis": false,
        "vis_epoch_steps": 100,
        "data_aug": {
            "use_aug": true,
            "img": {
                "rotation": 60.0,
                "horizontal_flip": 0.5,
                "vertical_flip": 0.5,
                "color": 0.3
            },
            "use_aug_3D": true,
            "pcs": {
                "granularity": [
                    0.05,
                    0.2,
                    0.4
                ],
                "magnitude": [
                    0.2,
                    0.4,
                    0.4
                ]
            }
        }
    },
    "val": {
        "batch_size": 16,
        "num_workers": 16,
        "pretrained": "./",
        "room_retrieval": {
            "retrieval": false,
            "epsilon_th": 0.8,
            "method_name": ""
        }
    },
    "other": {
        "use_resume": false,
        "resume": "home/yang/toolbox/ECCV2024/CodePlace/Results/train/./snapshots/epoch-8.pth.tar",
        "resume_folder": ""
    },
    "model_name": "ObjectPatchAligner",
    "output_dir": "home/yang/toolbox/ECCV2024/CodePlace/Results/train",
    "mode": "train",
    "seed": 42,
    "snapshot_dir": "home/yang/toolbox/ECCV2024/CodePlace/Results/train/snapshots",
    "log_dir": "home/yang/toolbox/ECCV2024/CodePlace/Results/train/logs",
    "event_dir": "home/yang/toolbox/ECCV2024/CodePlace/Results/train/events"
}
[2024-04-26 22:20:14] [DEBU] Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[2024-04-26 22:20:14] [DEBU] Creating converter from 7 to 5
[2024-04-26 22:20:14] [DEBU] Creating converter from 5 to 7
[2024-04-26 22:20:14] [DEBU] Creating converter from 7 to 5
[2024-04-26 22:20:14] [DEBU] Creating converter from 5 to 7
[2024-04-26 22:20:14] [INFO] Tensorboard is enabled. Write events to home/yang/toolbox/ECCV2024/CodePlace/Results/train/events.
[2024-04-26 22:20:14] [INFO] Using Single-GPU mode
